<!DOCTYPE html>
<html lang="es">
<head>
  <!-- ===== Meta b√°sicas ===== -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>PasswordMX ‚Äî Generador de Contrase√±as y Passphrases</title>
  <meta name="description" content="Genera contrase√±as seguras y passphrases al instante. 100% local, r√°pido y sin guardar datos. Copiar con un clic, selector de longitud, y medidor de fuerza." />
  <meta name="keywords" content="generador contrase√±as, passwords seguras, passphrases, zxcvbn, seguridad, M√©xico, PasswordMX" />
  <meta name="author" content="PasswordMX" />
  <meta name="theme-color" content="#0f172a" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">

  <!-- Canonical -->
  <link rel="canonical" href="https://passwordmx.online/" />

  <!-- Favicon + PWA icons (cache-bust con ?v=2) -->
  <link rel="icon" type="image/png" href="favicon.png?v=2">
  <link rel="apple-touch-icon" href="icon-192.png">

  <!-- Manifest -->
  <link rel="manifest" href="manifest.webmanifest">

  <!-- ===== Open Graph / Twitter ===== -->
  <meta property="og:title" content="PasswordMX ‚Äî Generador de Contrase√±as y Passphrases" />
  <meta property="og:description" content="Crea contrase√±as fuertes y passphrases seguras. Nada se guarda ni en el servidor." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://passwordmx.online/" />
  <meta property="og:image" content="og-image.png?v=2" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="PasswordMX ‚Äî Generador de Contrase√±as y Passphrases" />
  <meta name="twitter:description" content="Crea contrase√±as fuertes y passphrases seguras. Nada se guarda en el servidor." />
  <meta name="twitter:image" content="og-image.png?v=2" />

  <!-- ===== JSON-LD ===== -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "PasswordMX",
    "url": "https://passwordmx.online/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://passwordmx.online/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <!-- ===== Google AdSense ===== -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8014920114807705" crossorigin="anonymous"></script>
  <!-- Si activas Anuncios autom√°ticos en AdSense, con esta l√≠nea basta -->

  <!-- ===== Plausible Analytics (cookie-less) ===== -->
  <script defer data-domain="passwordmx.online" src="https://plausible.io/js/script.js"></script>

  <!-- ===== Estilos ===== -->
  <style>
    :root{
      --bg:#0f172a; --card:#111827; --muted:#384158; --text:#e2e8f0;
      --accent:#38bdf8; --accent-2:#22d3ee; --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444;
      --shadow: 10px 20px 40px rgba(0,0,0,.25);
      --topbar-h: 56px;          /* alto m√≥vil */
      --topbar-h-desktop: 64px;  /* alto desktop */
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f8fafc; --card:#ffffff; --muted:#475569; --text:#0f172a;
        --accent:#0891b2; --accent-2:#06b6d4; --shadow: 10px 24px rgba(2,8,23,.08);
      }
    }

    *{box-sizing:border-box}
    html, body{height:100%; min-height:100%;}
    body{
      margin:0;
      font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans";
      background: radial-gradient(1200px 600px at 50% 10%, rgba(56,189,248,.15), transparent 70%), var(--bg);
      color:var(--text);
    }

    /* ===== Topbar fija ===== */
    header.topbar{
      position: sticky;
      top: env(safe-area-inset-top, 0);
      z-index: 1000;
      height: var(--topbar-h);
      padding: calc(env(safe-area-inset-top, 0) * 1) 16px 0 16px;
      background: linear-gradient(180deg, rgba(2,8,23,.65), rgba(2,8,23,.35));
      backdrop-filter: blur(8px);
      border-bottom: 1px solid rgba(148,163,184,.15);
      display:flex; align-items:center; justify-content:center;
    }
    .topbar__inner{
      width:100%; max-width:980px;
      display:flex; align-items:center; justify-content:center;
      gap:10px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:700; letter-spacing:.3px;
      color: var(--accent);
      text-shadow:0 1px 0 rgba(0,0,0,.35);
    }
    .brand .lock{font-size:20px}
    .brand .title{font-size:18px}
    @media (min-width:900px){
      header.topbar{height: var(--topbar-h-desktop)}
      .brand .title{font-size:22px}
    }

    /* ===== Contenido principal ===== */
    main.container{
      width:100%; max-width:980px; margin:0 auto;
      padding: calc(var(--topbar-h) + env(safe-area-inset-top,0) + 24px) 16px 48px 16px;
      display:grid; gap:18px; grid-template-columns: 1fr .9fr; align-items:start;
    }
    @media (max-width:900px){
      main.container{
        grid-template-columns: 1fr;
        padding: calc(var(--topbar-h) + env(safe-area-inset-top,0) + 16px) 14px 64px 14px;
      }
    }

    .card{
      background: linear-gradient(180deg, rgba(2,8,23,.55), rgba(2,8,23,.35));
      border:1px solid rgba(148,163,184,.15);
      border-radius:16px; box-shadow: var(--shadow);
      padding:18px;
    }

    h1{margin:0 0 8px 0; font-size:26px; text-align:center}
    h3{margin:0 0 10px 0; font-size:18px}
    p, li{color: var(--text)}

    /* Footer minimal */
    footer{
      margin-top:8px; text-align:center; font-size:14px; color:#94a3b8;
    }
    .links{display:flex; gap:18px; justify-content:center; flex-wrap:wrap; margin-top:6px}
    .btn, a{color:var(--accent); text-decoration:none}
    .btn.ghost{
      background: transparent; border:1px solid rgba(148,163,184,.25); color:var(--text);
      border-radius:10px; padding:8px 14px; cursor:pointer;
    }
    .muted{color:#94a3b8}

    /* Controles */
    .slider{width:100%}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    @media (max-width:600px){ .row{grid-template-columns:1fr 1fr} }
    .gen-output{
      display:flex; gap:8px; align-items:center; background:#0b1220;
      border:1px solid rgba(148,163,184,.25); border-radius:12px; padding:8px 8px 8px 12px;
    }
    .copy{background:#22d3ee; color:#062a2f; border:0; border-radius:10px; padding:10px 14px; font-weight:700}

    /* Medidor */
    .meter{height:10px; background:#0b1220; border-radius:6px; border:1px solid rgba(148,163,184,.2)}
  </style>
</head>

<body>

  <!-- ===== TOPBAR ===== -->
  <header class="topbar">
    <div class="topbar__inner">
      <div class="brand">
        <span class="lock">üîí</span>
        <span class="title">Password<span style="color:#60a5fa">MX</span> ‚Äî Generador de Contrase√±as y Passphrases</span>
      </div>
    </div>
  </header>

  <!-- ===== CONTENIDO ===== -->
  <main class="container" role="main">
    <!-- Columna izquierda: generador -->
    <section class="card">
      <h3>Modo</h3>
      <div class="row" style="grid-template-columns: auto auto; align-items:center;">
        <label><input type="radio" name="mode" value="pwd" checked> Contrase√±a</label>
        <label><input type="radio" name="mode" value="pp"> Passphrase</label>
      </div>

      <p id="lenLabel" style="margin:14px 0 6px">Longitud <span id="lenVal" style="float:right">16</span></p>
      <input id="len" class="slider" type="range" min="8" max="64" value="16" />

      <div class="row" style="margin-top:12px">
        <label><input id="u" type="checkbox" checked> May√∫sculas</label>
        <label><input id="l" type="checkbox" checked> Min√∫sculas</label>
        <label><input id="d" type="checkbox" checked> N√∫meros</label>
        <label><input id="s" type="checkbox"> S√≠mbolos</label>
        <label><input id="easy" type="checkbox"> F√°cil de leer (sin O/0, I/1)</label>
        <label><input id="noRep" type="checkbox"> Evitar repetidos</label>
      </div>

      <div class="gen-output" style="margin-top:12px">
        <input id="out" type="text" readonly style="flex:1; background:transparent; border:0; color:var(--text); font:600 18px/1.3 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;">
        <button id="copy" class="copy">Copiar</button>
      </div>

      <div class="meter" style="margin-top:10px"><div id="bar" style="height:100%; width:0%; border-radius:6px; background:linear-gradient(90deg,#ef4444,#f59e0b,#22c55e)"></div></div>
      <p class="muted" style="margin:6px 0 0">Fuerza: <span id="score">‚Äî</span> <span id="bits" class="muted"></span></p>
      <button id="regen" class="btn ghost" style="margin-top:10px">‚Üª Regenerar</button>
    </section>

    <!-- Columna derecha: explicaci√≥n -->
    <aside class="card">
      <h3 style="margin:0 0 8px">¬øQu√© hace √∫nica a PasswordMX?</h3>
      <ul style="margin:0 0 8px 18px">
        <li><strong>Generaci√≥n 100% local</strong> con <code>crypto.getRandomValues()</code>.</li>
        <li><strong>Medidor de fuerza</strong> basado en <em>entrop√≠a</em>.</li>
        <li><strong>Opciones:</strong> s√≠mbolos, evitar repetidos, f√°cil de leer.</li>
        <li><strong>Modo Passphrase</strong> (frases de palabras) con separadores.</li>
      </ul>
      <p class="muted">Recomendamos usar un <em>gestor de contrase√±as</em> (Bitwarden, 1Password, etc.).</p>
      <p class="muted" style="font-size:12px">Aviso: no almacenamos ni compartimos tus contrase√±as. Uso bajo tu propia responsabilidad.</p>
      <p class="muted">Si esto te sirvi√≥, <a href="https://buymeacoffee.com/arkashghrollo" target="_blank" rel="noopener">inv√≠tame un caf√© ‚òï</a>.</p>
    </aside>

    <!-- Footer -->
    <footer style="grid-column:1 / -1">
      <div>¬© 2025 PasswordMX ‚Äî Hecho con üíô en M√©xico.</div>
      <div class="links">
        <a class="muted" href="faq.html">FAQ</a>
        <a class="muted" href="privacy.html">Privacidad</a>
        <a class="muted" href="contacto.html">Contacto</a>
      </div>
      <div style="margin-top:10px">
        <button id="shareBtn" class="btn ghost">Compartir</button>
      </div>
    </footer>
  </main>

  <!-- ===== L√≥gica ===== -->
  <script>
    // ---------- Service Worker ----------
    window.addEventListener('load', () => {
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/service-worker.js')
          .then(() => console.log('‚úÖ Service worker registrado'))
          .catch(err => console.log('‚ùå Error registrando SW:', err));
      }
    });

    // ---------- Utilidades ----------
    const $ = s => document.querySelector(s);
    const rand = max => crypto.getRandomValues(new Uint32Array(1))[0] % max;
    const log2 = x => Math.log(x) / Math.log(2);

    // ---------- Controles ----------
    const len = $('#len'), lenVal = $('#lenVal'), lenLabel = $('#lenLabel');
    const out = $('#out'), copy = $('#copy'), regen = $('#regen');
    const flags = {u:$('#u'), l:$('#l'), d:$('#d'), s:$('#s'), easy:$('#easy'), noRep:$('#noRep')};
    const bar = $('#bar'), scoreTxt = $('#score'), bitsTxt = $('#bits');
    const modeRadios = Array.from(document.querySelectorAll('input[name="mode"]'));

    // pools
    const EASY = /[O0Il1]/g;
    const SYM  = "!@#$%^&*()_+{}[]<>?=/.~-:";
    const U    = "ABCDEFGHJKLMNPQRSTUVWXYZ";
    const L    = "abcdefghijkmnopqrstuvwxyz";
    const D    = "23456789";

    // Passphrase
    let WORDS = null;                     // array con 2048 palabras (se carga abajo)
    const SEP_BASE = ['-', '_', '.'];     // separadores por defecto
    const SEP_PLUS = ['-', '_', '.', ':', '/', '+', '~']; // si marcas "S√≠mbolos"

    // Carga del wordlist (no bloquea la app)
    fetch('words-es-2048.json')
      .then(r => r.json())
      .then(list => { WORDS = Array.isArray(list) ? list : (list.words || []); })
      .catch(() => console.warn('No se pudo cargar words-es-2048.json'));

    // ---------- Generaci√≥n ----------
    function poolChars(){
      let p = '';
      if (flags.u.checked) p += U;
      if (flags.l.checked) p += L;
      if (flags.d.checked) p += D;
      if (flags.s.checked) p += SYM;
      if (!p) p = L + D; // fallback
      if (flags.easy.checked) p = p.replace(EASY,'');
      return p;
    }

    function genPassword(n){
      const p = poolChars();
      let s = '';
      while (s.length < n){
        const ch = p[rand(p.length)];
        if (flags.noRep.checked && s.length && s[s.length-1] === ch) continue;
        s += ch;
      }
      return s;
    }

    function capFirst(w){ return w.charAt(0).toUpperCase() + w.slice(1); }

    function genPassphrase(wordsCount){
      if (!WORDS || WORDS.length === 0){
        // fallback: mientras carga wordlist, devuelve una pseudo frase segura
        return genPassword(Math.max(12, wordsCount*4));
      }
      const sepPool = flags.s.checked ? SEP_PLUS : SEP_BASE;
      const used = new Set();
      const parts = [];
      while (parts.length < wordsCount){
        const w = WORDS[rand(WORDS.length)];
        if (flags.noRep.checked && used.has(w)) continue;
        used.add(w);
        parts.push(flags.u.checked ? capFirst(w) : w.toLowerCase());
      }
      const sep = sepPool[rand(sepPool.length)];
      let phrase = parts.join(sep);
      if (flags.d.checked) phrase += sep + String(rand(100)).padStart(2,'0'); // un numerito opcional
      return phrase;
    }

    function isPassphraseMode(){
      return document.querySelector('input[name="mode"]:checked').value === 'pp';
    }

    function updateLenUI(){
      if (isPassphraseMode()){
        len.min = 3; len.max = 12;
        if (len.value < 3 || len.value > 12) len.value = 4;
        lenLabel.firstChild.textContent = 'Palabras ';
      }else{
        len.min = 8; len.max = 64;
        if (len.value < 8) len.value = 16;
        lenLabel.firstChild.textContent = 'Longitud ';
      }
      lenVal.textContent = len.value;
    }

    function generate(){
      const n = parseInt(len.value, 10);
      const value = isPassphraseMode() ? genPassphrase(n) : genPassword(n);
      out.value = value;
      meter(value);
    }

    // ---------- Medidor de fuerza por entrop√≠a ----------
    function meter(str){
      let bits = 0;

      if (isPassphraseMode()){
        // entrop√≠a ‚âà #palabras * log2(tama√±o_wordlist) + extras
        const wordsCount = parseInt(len.value,10);
        const base = (WORDS && WORDS.length) ? WORDS.length : 2048;
        bits = wordsCount * log2(base);
        if (flags.d.checked) bits += log2(100);        // 2 d√≠gitos
        if (flags.s.checked) bits += log2(SEP_PLUS.length);
        if (flags.u.checked) bits += wordsCount * 1;   // capitalizaci√≥n inicial ‚âà 1 bit por palabra
      }else{
        // entrop√≠a ‚âà longitud * log2(pool)
        const p = poolChars();
        const variety = new Set(p.split('')).size;
        bits = str.length * log2(variety || 2);
      }

      // Mapeo de bits ‚Üí 0..100 (aprox)
      // < 40: d√©bil, 40‚Äì80: fuerte, > 80: muy fuerte
      const pct = Math.max(0, Math.min(100, Math.round(bits)));
      bar.style.width = Math.min(100, pct) + '%';
      const label = bits < 40 ? 'D√©bil' : bits < 80 ? 'Fuerte' : 'Muy fuerte';
      scoreTxt.textContent = label;
      bitsTxt.textContent = `(${Math.round(bits)} bits)`;
    }

    // ---------- Eventos ----------
    len.addEventListener('input', () => { lenVal.textContent = len.value; generate(); });
    Object.values(flags).forEach(el => el.addEventListener('change', generate));
    regen.addEventListener('click', generate);
    modeRadios.forEach(r => r.addEventListener('change', () => { updateLenUI(); generate(); }));

    copy.addEventListener('click', async () => {
      try { await navigator.clipboard.writeText(out.value); copy.textContent = '¬°Copiado!'; }
      catch(e){ /* noop */ }
      setTimeout(()=>copy.textContent='Copiar', 900);
    });

    // Compartir
    (function(){
      const btn = document.getElementById('shareBtn');
      const url = 'https://passwordmx.online/?utm_source=share&utm_medium=button&utm_campaign=app';
      btn.addEventListener('click', async () => {
        const data = { title: 'PasswordMX', text: 'Genera contrase√±as seguras (100% local).', url };
        if (navigator.share){ try{ await navigator.share(data); }catch(e){} }
        else{ await navigator.clipboard.writeText(url); btn.textContent='¬°Link copiado!'; setTimeout(()=>btn.textContent='Compartir',900); }
      });
    })();

    // ---------- Primera generaci√≥n ----------
    updateLenUI();
    generate();
  </script>
</body>
</html>
